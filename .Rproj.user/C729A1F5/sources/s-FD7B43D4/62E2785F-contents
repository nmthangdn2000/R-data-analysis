library(ggplot2)
library(car)
library(caret)
library(corrplot)

#Loading data
data(mtcars) 

View(mtcars)
# Looking at variables
str(mtcars)
dim(mtcars)
head(mtcars)
summary(mtcars)
names(mtcars)

#------------------------
# Data Preparation
# converting variables to factors.
mtcars$am   = as.factor(mtcars$am)
mtcars$cyl  = as.factor(mtcars$cyl)
mtcars$vs   = as.factor(mtcars$vs)
mtcars$gear = as.factor(mtcars$gear)
#Dropping dependent variable for calculating Multicollinearity

mtcars_a = subset(mtcars, select = -c(mpg))


#Identifying numeric variables
numericData <- mtcars_a[sapply(mtcars_a, is.numeric)]

#Calculating Correlation
descrCor <- cor(numericData)
descrCor

# Print correlation matrix and look at max correlation
print(descrCor)

#visualize correlation Matrix
corrplot(descrCor,order = "FPC", method = "color", type = "lower", tl.cex= 0.7, tl.col = rgb(0,0,1))

#Checking variable names of highly correlated variables



