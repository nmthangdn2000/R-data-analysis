library(ggplot2)
library(car)
library(caret)
library(corrplot)

df <- read.csv("D:/dataset/data2.csv")

dim(df)

df <- df[,-1]


# y la bien dap ung
model <- lm(y~x1, data = df)
summary(model)

model2 <- lm(y~x1+x2,df)
summary(model2)

# moi quan he
windows()
pairs(df)

modelAll <- lm(y~x1+x2+x3+x4+x5+x6+x7,df)
summary(modelAll)

coefficients(modelAll) #model coefficients

anova(modelAll)

model07 <- lm(y~.,df)

coefficients(model07)

step(model07) 

modelbest <- lm(y~x6+x7,df)
summary(modelbest)

summary(model07)

descrCor <- cor(df) #calculate correlation matrix

descrCor

#visualize correlation matrix
corrplot(descrCor,order = "FPC", method="color", type="lower", tl.cex = 0.7,tl.col=rgb(0,0,0))

#Checking variables that are highly correlated variables
highlyCorcol = findCorrelation(descrCor,cutoff=0.7)

highlyCorcol






# 
# data <- read.csv("D:/dataset/data3.csv")
# data <- na.omit(data)
# data <- data[,-which(names(data) %in% c("id"))]
# 
# 
# md <- lm(sway~.,data)
# summary(md)
# 
# step(md)
# 
# test <- lm(sway ~ gender + priofx_any + timehip + fnbmd + lsbmd + 
#              quad + age,data)
# 
# summary(test)
