data <- read.csv('D:/dataset/adult.csv')
data <- ISLR::Default
dim(data)

set.seed(1)

sample <- sample(c(TRUE,FALSE), nrow(data), replace = TRUE, prob = c(0.7,0.3))
train <- data[sample,]
test <- data[!sample,]



model <- glm(default~student+balance+income,family="binomial", data=train)
model2 <- glm(student~default+balance+income,family="binomial", data=train)

summary(model2)

new <- data.frame(balance = 1400, income = 2000, student = c("YES","NO"))

library(InformationValue)

test$default <- ifelse(test$default=="YES", 1, 0)

optimal <- optimalCutoff(test$default, predicted)[1]
optimal
confusionMatrix(test$default, predicted)

sensitivity(test$default, predicted)